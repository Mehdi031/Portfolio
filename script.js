const data = {
  name: "Mehdi Chougrani",
  subtitle: "√âtudiant en 2·µâ ann√©e de BUT Informatique √† l‚ÄôIUT de Villetaneuse (Universit√© Sorbonne Paris Nord)",
  accroche_phrases: [
    "Toujours pr√™t √† apprendre et √† relever de nouveaux d√©fis‚ÄØ!",
    "Passionn√© par la cybers√©curit√© et le d√©veloppement web.",
    "Curieux, motiv√© et engag√© dans la tech !"
  ],
  email: "mehdichougrani95140@gmail.com",
  github_url: "https://github.com/Mehdi031",
  cv: "CV_2025-06-16_Mehdi_CHOUGRANI.pdf",
  apropos: [
    "Actuellement √©tudiant en deuxi√®me ann√©e de BUT Informatique √† l‚ÄôIUT de Villetaneuse (Universit√© Sorbonne Paris Nord), je me passionne pour l‚Äôinformatique depuis le coll√®ge.",
    "Ma curiosit√© et mon envie de progresser m‚Äôont naturellement orient√© vers la cybers√©curit√© et le d√©veloppement web.",
    "Je privil√©gie l‚Äôapprentissage par la pratique‚ÄØ: projets, challenges, stages et veille technique rythment mon quotidien.",
    "En dehors des √©crans, je suis un grand fan de football üèÜ, passionn√© de musculation, amateur de jeux vid√©o et de lecture. Ces activit√©s d√©veloppent mon esprit d‚Äô√©quipe, ma pers√©v√©rance et mon ouverture d‚Äôesprit.",
    "Mon objectif‚ÄØ: poursuivre en Master Cybers√©curit√©, pour prot√©ger le monde num√©rique de demain‚ÄØ!"
  ],
  skills: [
    {
      group: "Langages de programmation",
      icons: [
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/python/python-original.svg", label: "Python"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/javascript/javascript-original.svg", label: "JavaScript"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/java/java-original.svg", label: "Java"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/php/php-original.svg", label: "PHP"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/c/c-original.svg", label: "C"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/bash/bash-original.svg", label: "Bash"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/html5/html5-original.svg", label: "HTML5"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/css3/css3-original.svg", label: "CSS3"}
      ]
    },
    {
      group: "Frameworks & Biblioth√®ques",
      icons: [
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/nodejs/nodejs-original.svg", label: "Node.js"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/react/react-original.svg", label: "React"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vuejs/vuejs-original.svg", label: "Vue.js"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/tailwindcss/tailwindcss-plain.svg", label: "Tailwind"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/typescript/typescript-original.svg", label: "TypeScript"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/spring/spring-original.svg", label: "Spring"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/nestjs/nestjs-plain.svg", label: "NestJS"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/nextjs/nextjs-original.svg", label: "Next.js"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/scikitlearn/scikitlearn-original.svg", label: "scikit-learn"}
      ]
    },
    {
      group: "Manipulation de donn√©es",
      icons: [
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/postgresql/postgresql-original.svg", label: "PostgreSQL"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/graphql/graphql-plain.svg", label: "GraphQL"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/mysql/mysql-original.svg", label: "MySQL"}
      ]
    },
    {
      group: "Syst√®mes d‚Äôexploitation",
      icons: [
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/windows8/windows8-original.svg", label: "Windows"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/linux/linux-original.svg", label: "Linux"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/apple/apple-original.svg", label: "MacOS"}
      ]
    },
    {
      group: "Logiciels",
      icons: [
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vscode/vscode-original.svg", label: "VSCode"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/jetbrains/jetbrains-original.svg", label: "JetBrains"},
        {img: "https://upload.wikimedia.org/wikipedia/commons/7/7e/Spyder_logo.svg", label: "Spyder"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/jupyter/jupyter-original.svg", label: "Jupyter"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/git/git-original.svg", label: "Git"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg", label: "GitHub"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/office/office-plain.svg", label: "Office"},
        {img: "https://cdn.jsdelivr.net/gh/devicons/devicon/icons/powerbi/powerbi-original.svg", label: "Power BI"},
        {img: "https://seeklogo.com/images/T/talend-logo-5B9B5D7952-seeklogo.com.png", label: "Talend"}
      ]
    }
  ],
  qualites: [
    {
      icon: "üí°",
      titre: "Ce dont je suis le plus fier",
      desc: "Ma capacit√© √† <b>apprendre rapidement</b> et √† m'adapter aux nouvelles technologies. En deux ans de BUT, j'ai su ma√Ætriser plusieurs langages et r√©soudre des probl√®mes complexes avec m√©thode et pers√©v√©rance."
    },
    {
      icon: "üéØ",
      titre: "Autonome",
      desc: "Capable de travailler de mani√®re ind√©pendante, de prendre des initiatives et de mener mes projets √† terme sans supervision constante."
    },
    {
      icon: "üí≠",
      titre: "Cr√©atif",
      desc: "J‚Äôaime trouver des solutions innovantes aux probl√®mes techniques et explorer de nouvelles approches pour optimiser le code ou l‚Äôexp√©rience utilisateur."
    },
    {
      icon: "üóÇÔ∏è",
      titre: "Organis√©",
      desc: "M√©thodique dans ma planification, je structure mes projets avec rigueur et respecte les d√©lais gr√¢ce √† une gestion efficace du temps."
    },
    {
      icon: "ü§ù",
      titre: "Esprit d‚Äô√©quipe",
      desc: "J‚Äôappr√©cie le travail collaboratif, sais √©couter les id√©es des autres et contribue positivement √† la dynamique de groupe."
    },
    {
      icon: "üîÑ",
      titre: "Adaptable",
      desc: "Flexible face aux changements, je m‚Äôadapte rapidement aux nouvelles technologies et aux √©volutions des projets."
    },
    {
      icon: "üìä",
      titre: "Analytique",
      desc: "J‚Äôai une approche logique et structur√©e pour analyser les probl√®mes et d√©composer les t√¢ches complexes en √©tapes g√©rables."
    }
  ],
  experience: [
    {
      date: "2024 ‚Äì Pr√©sent",
      title: "Agent d'attraction",
      place: "Parc Ast√©rix",
      desc: "Accueil et animation aupr√®s du public, gestion de la s√©curit√© et r√©solution de situations impr√©vues. Ce poste m‚Äôa permis de d√©velopper mon sens du relationnel, ma r√©activit√© et la gestion du stress."
    },
    {
      date: "2022 ‚Äì Pr√©sent",
      title: "B√©n√©vole",
      place: "ACIM",
      desc: "Distribution de repas, organisation d'√©v√©nements solidaires. Un engagement qui m‚Äôa appris l‚Äôimportance de l‚Äôentraide et du travail d‚Äô√©quipe."
    },
    {
      date: "Janv - Mars 2025",
      title: "Stage web (d√©veloppement, cybers√©curit√©)",
      place: "Lyman Agency (Garges-l√®s-Gonesse)",
      desc: "D√©veloppement d‚Äôun vrai site de r√©servation pour une entreprise de r√©novation : analyse des besoins, maquettes, fonctionnalit√©s compl√®tes (r√©servation, base de donn√©es, s√©curit√©, interface admin). Projet livr√© mais non h√©berg√© par l‚Äôentreprise (d√©monstrateur interne)."
    }
  ],
  projets: [
    {
      title: "SAE_AppChatAnnotation",
      desc: `Projet universitaire sur la mod√©ration et l‚Äôannotation automatique de messages‚ÄØ: r√©alisation d‚Äôun outil en Java/Python, gestion de l‚ÄôUI, impl√©mentation d‚Äôalgorithmes simples de d√©tection. <a href="https://github.com/Mehdi031/SAE_AppChatAnnotation" style="color:#4a90e2;" target="_blank">Voir sur GitHub</a>`
    },
    {
      title: "Site de r√©servation (stage)",
      desc: "D√©veloppement d‚Äôun vrai site de r√©servation pour une entreprise de r√©novation‚ÄØ: cahier des charges, maquettes, s√©curit√©, gestion des r√©servations et interface administrateur. Projet livr√© mais non h√©berg√© par l‚Äôentreprise."
    }
  ]
};

// ----------- G√©n√©ration des sections -----------

function nav() {
  return `<ul>
    <li><a href="#accueil" class="active">Accueil</a></li>
    <li><a href="#apropos">√Ä propos de moi</a></li>
    <li><a href="#competences">Comp√©tences</a></li>
    <li><a href="#qualites">Qualit√©s</a></li>
    <li><a href="#experience">Exp√©rience</a></li>
    <li><a href="#projets">Projets</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>`;
}

function accueil() {
  return `
  <section class="accueil section" id="accueil" style="position:relative;">
    <div class="avatar-large"><span>M</span></div>
    <h1>${data.name}</h1>
    <div id="badgeLudique" class="badge-ludique" title="D√©place-moi !">üñ•Ô∏è</div>
    <div class="accroche"><span class="typed-text"></span></div>
    <div class="subtitle">${data.subtitle}</div>
    <a href="#contact" class="btn-main">Me contacter</a>
  </section>
  `;
}

function apropos() {
  return `
  <section class="section apropos" id="apropos">
    <h2>√Ä propos de moi</h2>
    ${data.apropos.map(txt=>`<p>${txt}</p>`).join("")}
  </section>
  `;
}

function competences() {
  return `
  <section class="section" id="competences">
    <h2>Comp√©tences techniques</h2>
    <div class="tech-cards-flex">
      ${data.skills.map(group=>`
        <div class="tech-card">
          <h3>${group.group}</h3>
          <div class="tech-icons">
            ${group.icons.map(i=>`
              <span class="icon-label">
                <img src="${i.img}" alt="${i.label}" title="${i.label}">
                <span>${i.label}</span>
              </span>
            `).join("")}
          </div>
        </div>
      `).join("")}
    </div>
  </section>
  `;
}

function qualites() {
  return `
  <section class="section" id="qualites">
    <h2>Qualit√©s</h2>
    <div class="qualites-header fiert√©">
      <span class="q-icon">${data.qualites[0].icon}</span>
      <b>${data.qualites[0].titre}</b>
      <div style="margin-top:0.8em; color:#4a90e2;">${data.qualites[0].desc}</div>
    </div>
    <div class="qualites-cards">
      ${data.qualites.slice(1).map(q=>`
        <div class="qualite-card">
          <span class="q-icon">${q.icon}</span>
          <span class="q-title">${q.titre}</span>
          <div>${q.desc}</div>
        </div>
      `).join("")}
    </div>
  </section>
  `;
}

function experience() {
  return `
  <section class="section" id="experience">
    <h2>Exp√©riences professionnelles</h2>
    <div class="timeline-cards">
      ${data.experience.map(e=>`
        <div class="timeline-card">
          <span class="date">${e.date}</span>
          <div class="title">${e.title}</div>
          <div class="place">${e.place}</div>
          <div class="desc">${e.desc}</div>
        </div>`).join("")}
    </div>
  </section>
  `;
}
function projets() {
  return `
  <section class="section" id="projets">
    <h2>Projets</h2>
    <div class="projects-cards">
      ${data.projets.map(p=>`
        <div class="project-card">
          <div class="project-title">${p.title}</div>
          <div class="desc">${p.desc}</div>
        </div>`).join("")}
    </div>
  </section>
  `;
}

function contact() {
  return `
  <section class="section" id="contact">
    <h2>Contact</h2>
    <form class="contact-form" action="https://formspree.io/f/mayrnvjz" method="POST">
      <input type="text" name="name" placeholder="Votre nom" required>
      <input type="email" name="email" placeholder="Votre email" required>
      <textarea name="message" rows="5" placeholder="Votre message" required></textarea>
      <button type="submit">Envoyer</button>
    </form>
    <div class="contact-social">
      <a href="mailto:${data.email}" style="color:#4a90e2;font-weight:600;">
        ${data.email}
      </a>
      <a href="${data.github_url}" target="_blank" class="github-icon-link" title="Voir mon GitHub" style="display: flex; align-items: center; gap:0.4em;">
        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" alt="GitHub" style="height:28px;">
        <span>GitHub</span>
      </a>
    </div>
    <div>
      <a class="btn-main" href="${data.cv}" download style="margin-top:1.2em;display:inline-block;">T√©l√©charger mon CV (PDF)</a>
    </div>
  </section>
  `;
}

function footer() {
  return `<div>¬© 2025 Mehdi Chougrani - Portfolio personnel</div>`;
}

// -------- Typed effect accueil (texte anim√©) --------
function typedAccueil() {
  const el = document.querySelector('.typed-text');
  if (!el) return;
  const phrases = data.accroche_phrases;
  let i = 0, j = 0, erase = false;

  function typeLoop() {
    el.textContent = phrases[i].substring(0, j);
    if (!erase && j < phrases[i].length) {
      j++; setTimeout(typeLoop, 44);
    } else if (!erase && j === phrases[i].length) {
      erase = true; setTimeout(typeLoop, 1300);
    } else if (erase && j > 0) {
      j--; setTimeout(typeLoop, 17);
    } else {
      erase = false; i = (i + 1) % phrases.length; setTimeout(typeLoop, 400);
    }
  }
  typeLoop();
}

// -------- Badge draggable (ludique) --------
function badgeDraggable() {
  const badge = document.getElementById('badgeLudique');
  let offsetX, offsetY, dragging = false;

  badge.addEventListener('mousedown', startDrag);
  badge.addEventListener('touchstart', startDragTouch);

  function startDrag(e) {
    dragging = true;
    const rect = badge.getBoundingClientRect();
    offsetX = e.clientX - rect.left;
    offsetY = e.clientY - rect.top;
    document.addEventListener('mousemove', onDrag);
    document.addEventListener('mouseup', stopDrag);
  }
  function onDrag(e) {
    if (!dragging) return;
    badge.style.left = (e.clientX - offsetX) + 'px';
    badge.style.top = (e.clientY - offsetY) + 'px';
    badge.style.transform = 'none';
  }
  function stopDrag() {
    dragging = false;
    document.removeEventListener('mousemove', onDrag);
    document.removeEventListener('mouseup', stopDrag);
  }
  // Touch support (mobile)
  function startDragTouch(e) {
    dragging = true;
    const touch = e.touches[0];
    const rect = badge.getBoundingClientRect();
    offsetX = touch.clientX - rect.left;
    offsetY = touch.clientY - rect.top;
    document.addEventListener('touchmove', onDragTouch);
    document.addEventListener('touchend', stopDragTouch);
  }
  function onDragTouch(e) {
    if (!dragging) return;
    const touch = e.touches[0];
    badge.style.left = (touch.clientX - offsetX) + 'px';
    badge.style.top = (touch.clientY - offsetY) + 'px';
    badge.style.transform = 'none';
  }
  function stopDragTouch() {
    dragging = false;
    document.removeEventListener('touchmove', onDragTouch);
    document.removeEventListener('touchend', stopDragTouch);
  }
}

// --------- Nav active + scroll fluide ----------
function navActive() {
  const navLinks = document.querySelectorAll('nav a');
  window.addEventListener('scroll', function() {
    let fromTop = window.scrollY + 110;
    navLinks.forEach(link => {
      const section = document.querySelector(link.getAttribute("href"));
      if(!section) return;
      if(section.offsetTop <= fromTop && section.offsetTop + section.offsetHeight > fromTop) {
        navLinks.forEach(l=>l.classList.remove("active"));
        link.classList.add("active");
      }
    });
  });
  navLinks.forEach(link => {
    link.addEventListener("click", function(e) {
      if(this.hash && document.querySelector(this.hash)) {
        e.preventDefault();
        document.querySelector(this.hash).scrollIntoView({behavior: "smooth"});
      }
    });
  });
}

document.addEventListener("DOMContentLoaded", function() {
  document.getElementById('navbar').innerHTML = nav();
  document.getElementById('main').innerHTML = [
    accueil(),
    apropos(),
    competences(),
    qualites(),
    experience(),
    projets(),
    contact()
  ].join('');
  document.getElementById('footer').innerHTML = footer();
  typedAccueil();
  navActive();
  badgeDraggable();
});
